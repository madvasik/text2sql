# Text-to-SQL (SQLite) — Mistral SDK

Генерация SQL запросов из естественного языка через Mistral API для SQLite.

## Реализовано

### Основной функционал
- Генерация `SELECT` запросов из NL через Mistral API (модели: mistral-small-latest, open-mistral-7b с fallback)
- Read-only выполнение SQL (только SELECT, защита от инъекций)
- Импорт нескольких CSV файлов в SQLite с автоопределением типов данных
  - Каждый CSV файл автоматически становится таблицей с именем файла (без расширения)
  - Все таблицы хранятся в одной базе данных, что позволяет делать JOIN между ними
- Поддержка TXT файлов с описанием схемы таблицы для улучшения генерации

### Дополнительные фичи
- Автоматическая визуализация результатов (столбчатые, линейные, круговые графики)
- Генерация пояснений SQL и результатов через LLM
- Экспорт результатов: CSV, XLSX, PNG графики
- Валидация API ключа перед использованием
- Автоопределение колонок для графиков

## Быстрый старт

```cmd
python -m venv .venv
.venv\Scripts\activate
pip install -r requirements.txt
```

**Запуск:**
```cmd
streamlit run streamlit_app.py
```

## Использование

1. **Загрузка данных:**
   - В боковой панели загрузите один или несколько CSV файлов
   - Каждый файл автоматически станет таблицей с именем файла (например, `sales.csv` → таблица `sales`)
   - Опционально загрузите TXT файл с описанием структуры таблиц для улучшения генерации SQL

2. **Запросы:**
   - Введите вопрос на естественном языке
   - Система автоматически сгенерирует SQL запрос и выполнит его
   - Результаты можно визуализировать и экспортировать

## Структура
- `text2sql/db.py` — работа с SQLite, импорт CSV, выполнение SELECT
- `text2sql/llm.py` — Mistral API: генерация SQL, пояснения, визуализация
- `streamlit_app.py` — Streamlit веб-интерфейс